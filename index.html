<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gomoku</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="switch-container">
        <main class="switch-card">
            <h1>五子棋</h1>

            <!-- Landing Page / Game Selection -->
            <div id="landing-page">
                <div class="game-tile" onclick="toggleModeSelection()">
                    <div class="game-icon">⚫⚪</div>
                    <h2>Gomoku 五子棋</h2>
                </div>

                <div id="mode-selection" class="hidden">
                    <button class="pill-btn mode-btn" onclick="selectMode('ai')">對 AI 對戰</button>
                    <button class="pill-btn mode-btn" onclick="selectMode('online')">Online 對戰</button>
                </div>
            </div>

            <!-- Game Container (Hidden on Landing) -->
            <div id="game-container" class="hidden">

                <!-- VS AI Specific Controls -->
                <div id="ai-controls" class="hidden">
                    <div class="controls-card">
                        <label for="difficulty">難度：</label>
                        <select id="difficulty" class="pill-select">
                            <option value="easy">Easy</option>
                            <option value="medium">Medium</option>
                            <option value="hard" selected>Hard</option>
                        </select>
                    </div>
                </div>

                <!-- Online Lobby (Room List) -->
                <div id="online-lobby" class="hidden">
                    <h3>選擇房間</h3>
                    <div class="room-grid">
                        <div class="room-card" onclick="joinRoom('room1')">
                            <div class="room-name">Room 1</div>
                            <div class="room-stats"><span id="room1-count">--</span></div>
                        </div>
                        <div class="room-card" onclick="joinRoom('room2')">
                            <div class="room-name">Room 2</div>
                            <div class="room-stats"><span id="room2-count">--</span></div>
                        </div>
                        <div class="room-card" onclick="joinRoom('room3')">
                            <div class="room-name">Room 3</div>
                            <div class="room-stats"><span id="room3-count">--</span></div>
                        </div>
                    </div>
                    <button class="pill-btn secondary" onclick="backToLanding()">返回主選單</button>
                </div>

                <!-- Online Room View (Board + Details) -->
                <div id="online-room" class="hidden">
                    <div class="room-header-card">
                        <div class="room-status">
                            <span class="label">房間：</span><span id="current-room-id" class="value"></span>
                            <span class="divider">|</span>
                            <span class="label">身份：</span><span id="my-role" class="value">觀眾</span>
                        </div>
                    </div>

                    <div id="role-selection">
                        <button id="btn-claim-black" class="pill-btn role-btn"
                            onclick="becomePlayer('black')">成為黑子玩家</button>
                        <button id="btn-claim-white" class="pill-btn role-btn"
                            onclick="becomePlayer('white')">成為白子玩家</button>
                        <button id="btn-claim-spec" class="pill-btn role-btn secondary"
                            onclick="becomeSpectator()">成為觀戰者</button>
                    </div>

                    <div class="room-actions">
                        <button id="online-start-btn" class="pill-btn action-btn hidden"
                            onclick="startOnlineGame()">開始遊戲</button>
                        <button id="leave-room-btn" class="pill-btn danger-btn" onclick="leaveRoom()">退出房間</button>
                    </div>
                </div>

                <!-- Common Game Elements (Board, Status) -->
                <div id="game-board-area" class="hidden">
                    <div class="board-frame">
                        <div id="board"></div>
                    </div>
                    <div id="status-bar">
                        <div id="status">當前回合：<span class="player-turn">黑子</span></div>
                    </div>
                    <button id="reset-btn" class="pill-btn action-btn" onclick="resetGame()">重新開始</button>
                </div>

            </div>
        </main>
    </div>
    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <!-- Add Firebase products that you want to use -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDIX2SINucrLofi5ceF3qI8wHMH6xyY6GQ",
            authDomain: "gomoku-85a0b.firebaseapp.com",
            projectId: "gomoku-85a0b",
            storageBucket: "gomoku-85a0b.firebasestorage.app",
            messagingSenderId: "1022980266439",
            appId: "1:1022980266439:web:978440b8b67eb30d1ae1e2",
            measurementId: "G-64785RPL06"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // Initialize Cloud Firestore and expose global db
        const db = firebase.firestore();
    </script>

    <script src="script.js"></script>
</body>

</html>